<!DOCTYPE html>
<html>
  <head>
    <title>Itinerary</title>
  </head>
  <body>
    <button onclick="getItinerary()">Today's Itinerary</button>
    <form id="custom-date-itinerary">
      <input id="date" type="date" placeholder="Enter a date..."/>
      <button type="submit">Get Itinerary</button>
    </form>
    <script>
        async function handleCustomDateFormSubmit(e) {
            e.preventDefault();
            const date = document.getElementById('date').value;
            if (date) {
                await getItinerary(new Date(date));
            }
        }

        async function getItinerary(date = new Date()) {
            const year = date.getUTCFullYear();
            const month = date.getUTCMonth() + 1 < 10
                ? `0${date.getUTCMonth() + 1}`
                : date.getUTCMonth() + 1;
            const day = date.getUTCDate()  < 10
                ? `0${date.getUTCDate()}`
                : date.getUTCDate();
            const response = await fetch(`/api/itinerary/${year}-${month}-${day}`);
            await showFile(await response.blob());
        }

        async function showFile(blob) {
            const pdfBlob = new Blob([blob], { type: 'application/pdf' });
            const url = URL.createObjectURL(pdfBlob);
            const link = document.createElement('a');
            link.href = url;
            document.body.appendChild(link);
            link.click();
        }

        document.getElementById('custom-date-itinerary')
            .addEventListener('submit', handleCustomDateFormSubmit);
    </script>
  </body>
</html>
